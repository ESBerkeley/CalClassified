{% extends "mobile/base.html" %}

{% block title %}Browse{% endblock %}
{% block header_title %}Browse{% endblock %}
{% block body_content %}

<div id="filter-container">
    <div id="filter-options">
        <form action="javascript: search();" id="search-form">
        <input type="search" name="search" id="search-basic" placeholder="Search Keywords..." value="" />
        </form>
        <div  data-role="fieldcontain">
            <fieldset data-role="controlgroup">
                <p style="margin-top: 0;">Filter by as many categories you'd like!</p>

                {% for category in categories %}

                <input type="checkbox" name="categories" id="id_category_{{ category.id }}" value="{{ category.id }}"/>
                <label for="id_category_{{ category.id }}">{{ category.name }}</label>
                {% endfor %}

            </fieldset>
        </div>

        <label for="min-price">Min Price</label>
        <input type="range" id="min-price" value="0" min="0" max="{{ max_price }}" data-highlight="true" />
        <br>
        <label for="max-price">Max Price</label>
        <input type="range" id="max-price" value="{{ max_price }}" min="0" max="{{ max_price }}" data-highlight="true" />
    </div>

    <div id="filter-button-container">  <!--necessary for jquery hide() to work)-->
        <button id="filter-button" data-icon="gear" data-mini="true">Filter Options</button>
    </div>

    <fieldset class="ui-grid-a">
	    <div class="ui-block-a"><button id="search-button" data-icon="gear" data-mini="true">Search</button></div>
	    <div class="ui-block-b"><button id="cancel-button" data-icon="gear" data-mini="true">Cancel</button></div>	   
    </fieldset>

</div>

        <div>
            <ul data-role="listview" id="browse-list">
                <!-- list of items -->
            </ul>
        </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">

    var preloaded = false;
    $('#body-page').live('pageshow', function () {
        // THIS IS HOW TO DO DOCUMENT READY
        var pathname = window.location.pathname;
        pathname = pathname.split("/")
        if(pathname.length > 1 && pathname[1]=="browse" && !preloaded){
            search();
            preloaded = true
        }
    });

    $(".ui-grid-a").hide();
    $("#filter-options").hide();

    $('.ui-input-clear').live('tap', function () {
        $("#search-basic").val("");
        search();
    });

    $("#filter-button").click(function(){
        $("#filter-button-container").hide();
        //$("#filter-button").html("Search").button("refresh");
        $(".ui-grid-a").show();   
        $("#filter-options").slideDown(); 
    });

    $("#search-button").click(function(){
        search();
    });

    $("#cancel-button").click(function(){
        $("#filter-button-container").show();
        $(".ui-grid-a").hide();   
        $("#filter-options").slideUp(); 
    });
    </script>
{% endblock %}
